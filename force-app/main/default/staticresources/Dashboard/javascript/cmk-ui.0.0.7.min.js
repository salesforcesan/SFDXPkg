(function(a){var f=["Id","Name"],h=["Id","Name","LocationNumber__c","Address__c","City__c","State__c","Retailer__c"];Date.prototype.isValid=function(){return Object.prototype.toString.call(this)==="[object Date]"&&isFinite(this)};Date.prototype.format=function(i){return i==="/"?[this.getMonth()+1,this.getDate(),this.getFullYear()].join("/"):this.toISOString()};String.prototype.toDate=function(){var l,k,j,i;if(!this){return null}i=this.split("/");if(i.length!==3){return null}k=parseInt(i[2]);l=parseInt(i[0])-1;j=parseInt(i[1]);return new Date(k,l,j,0,0,0,0)};function e(){return new SObjectModel.Project__c()}function d(){return new SObjectModel.ProjectType__c()}function b(){return new SObjectModel.Retailer__c()}function c(){return new SObjectModel.Client__c()}function g(){return new SObjectModel.Location__c()}a.module("cmk.system.async",[]).factory("cmkSystemAsync",["$q",function(j){function i(){}i.prototype.call=function(o,l,k){var n=j.defer();function m(r,q){var p=[];r.forEach(function(s){var t={};_.forEach(q,function(u){t[u]=s.get(u)||"-"});p[p.length]=t});return p}if(!!l){o(l,function(r,p,q){if(r){n.reject(r)}else{if(!!q){n.resolve(m(p,k),q)}else{n.resolve(m(p,k))}}})}else{o(function(r,p,q){var s;if(r){n.reject(r)}else{s=(k.length===0)?p[0]:m(p,k);if(!!q){n.resolve(s)}else{n.resolve(s,q)}}})}return n.promise};i.prototype.remoting=function(k,l){var n=j.defer(),m=["{!$RemoteAction.AccountRemoter.",k,"}"].join("");Visualforce.remoting.Manager.invokeAction(m,l,function(o,p){if(!!p.status){n.resolve(o)}else{if(p.type==="exception"){n.reject([p.message,p.where].join("\r\n"))}else{n.reject(p.message)}}});return n.promise};return new i()}]);a.module("cmk.service.project",["cmk.web.context","cmk.system.async"]).factory("projectService",["cmkWebContext","cmkSystemAsync",function(i,j){function k(q){var t="My Projects",r="CreatedDate",s="DESC",m=100,n=1,u={orderby:[],limit:m},o={};o[r]=s;u.orderby[0]=o;var p=i.logonUserId;p=p.substring(0,15);switch(t){case"My Projects":u.where={OwnerId__c:{eq:p}};break;case"Scheduled":u.where={Status__c:{eq:"Scheduled"}};break;case"Planning":u.where={Status__c:{eq:"Planning"}};break;case"Complete":u.where={Status__c:{eq:"Complete"}};break;case"In Progress":u.where={Status__c:{eq:"In Progress"}};break}return u}function l(){}l.prototype.getProjects=function(m){var n=e();queryParam=k(m);return j.call(n.retrieve,queryParam)};return new l()}]);a.module("cmk.service.lookupModel",["cmk.system.async"]).factory("cmkServiceLookupModel",["cmkSystemAsync",function(i){function j(){}j.prototype.projectTypes=function(){var k=d();return i.call(k.retrieve,"",f)};j.prototype.retailers=function(){var k=b();return i.call(k.retrieve,"",f)};j.prototype.clients=function(){var k=c();return i.call(k.retrieve,"",["Id","ClientName__c"])};j.prototype.findLocations=function(l){var n,k=g(),m={orderby:[{LocationNumber__c:"ASC"}],limit:50};if(!!l){n=l+"%";m={where:{or:{LocationNumber__c:{like:n},or:{City__c:{like:n},State__c:{like:n}}}},orderby:[{LocationNumber__c:"ASC"}],limit:50}}return i.call(k.retrieve,m,h)};return new j()}])})(angular);(function(a){a.module("cmk.ui.dropdown.area",["cmk.web.context","ngSanitize"]).directive("cmkDropdownArea",["cmkWebContext","$log",function(b,d){var c=b.staticResourcePath;return{restrict:"EA",transclude:true,require:["cmkDropdownArea"],scope:{width:"=",title:"@",alignment:"@",onInit:"&onInit",placeHolder:"@placeholder",cssclass:"@",icon:"@"},controller:"DropdownAreaController",template:function(){return'<div aria-expanded="{{uiModel.isHidden === false}}" class="picklist"><button class="button button--icon-more {{cssclass}} truncate" ng-click="wantToSelect($event)" ng-blur="onBlur()" aria-haspopup="true"><svg aria-hidden="true" class="button__icon"><use xlink:href="{{icon}}"></use></svg></button><div class="dropdown dropdown--small dropdown--nubbin-top dropdown--menu {{uiModel.alignment}} cm-dropdwon" ng-style="uiModel.lookupPostionStyle" ng-hide="uiModel.isHidden"><div class="cm-dropdown-area" ng-mouseover="onMouseOver()" ng-mouseleave="onMouseLeave()"><div class="cm-article"><header class="clearfix"><div class="float-left"><h2 class="text-heading--label text-heading--large cm-article-title">{{uiModel.title}}</h2></div><div class="float-right cm-float-right"><button title="Close" ng-click="onClose()" class="button button--icon-border button--icon-border-small"><svg aria-hidden="true" class="button__icon button__icon--small cm-icon"><use xlink:href="'+c+'/assets/icons/utility-sprite/svg/symbols.svg#close"></use></svg><span class="assistive-text">Close</span></button></div></header></div><ng-transclude></ng-transclude></div></div></div>'}}}]).controller("DropdownAreaController",["$scope","$log",function(f,h){var d=this,g=0,i=1,c=f,b=!!c.width?c.width:200,e=c.uiModel={isHidden:true,title:c.title,alignment:"dropdown--"+(c.alignment||"left"),lookupPostionStyle:{width:b}};if(!!c.alignment&&c.alignment==="right"){e.alignment="dropdown--right"}c.wantToSelect=function(j){e.isHidden=!e.isHidden;if(i&&!!c.onInit&&!e.isHidden){i=0,c.onInit()}};c.onBlur=function(){if(g===0){e.isHidden=true}};c.onMouseOver=function(){g=1};c.onMouseLeave=function(){g=0};c.onClose=function(){g=0;c.onBlur()}}])})(angular);(function(a){function b(e,c){var d=e.menuItems,f;if(!!c){d.forEach(function(g){if(g.key===c){f=g;g.selected=1;g.cssSelected="is-selected"}else{g.cssSelected="";g.selected=0}})}else{d.forEach(function(g){if(g.selected===1){f=g;g.cssSelected="is-selected"}else{g.cssSelected=""}})}if(!!e.setSelectIcon&&!!f){e.buttonUrl=f.leftIconUrl||f.rightIconUrl}}a.module("cmk.ui.dropdown",["cmk.web.context"]).directive("cmkDropdown",["cmkWebContext","$log",function(c,e){var d=c.staticResourcePath;return{restrict:"EA",transclude:true,scope:{alignment:"@",onClicked:"&onClicked",model:"=datasource",cssclass:"@"},controller:"DropdownListController",template:function(f,g){return'<div class="dropdown-trigger {{cssclass}}" aria-haspopup="true"><button class="button button--icon-more" aria-haspopup="true"><svg aria-hidden="true" class="button__icon"><use xlink:href="{{model.buttonUrl}}"></use></svg><span class="assistive-text">{{model.helpText}}</span><svg aria-hidden="true" class="button__icon button__icon--x-small"><use xlink:href="'+d+'/assets/icons/utility-sprite/svg/symbols.svg#down"></use></svg></button><div class="dropdown dropdown--nubbin-top {{uiModel.alignment}} dropdown--small dropdown--menu"><div class="dropdown__header" ng-hide="angular.isUndefined(model.title)"><span class="text-heading--label">{{model.title}}</span></div><ul class="dropdown__list" role="menu"><li data-id="{{item.key}}" ng-disabled="item.disabled === 1" ng-repeat="item in model.menuItems" aria-selected="{{item.selected === 1}}" class="dropdown__item has-icon--left" ng-class="item.cssSelected" role="menuitem option" tabindex="0"><a href="#{{item.key}}" tabindex="-1" aria-disabled="{{item.disabled === 1}}"><svg ng-if="!!item.leftIconUrl" aria-hidden="true" class="icon icon--small icon--left"><use xlink:href="{{item.leftIconUrl}}"></use></svg><svg aria-hidden="true" ng-if="model.showSelectIcon && item.selected" class="icon icon--small icon--left"><use xlink:href="'+d+'/assets/icons/standard-sprite/svg/symbols.svg#task2"></use></svg><span>{{item.value}}</span><svg ng-if="!!item.rightIconUrl" aria-hidden="true" class="icon icon--small icon--right"><use xlink:href="{{item.rightIconUrl}}"></use></svg></a></li></ul></div></div>'},link:function(i,h,g,f){h.on("click","a",function(j){j.preventDefault();var k=a.element(this).parent("li").attr("data-id");b(i.model,k);i.$digest();f.onSelect(k)})}}}]).controller("DropdownListController",["$scope","$log",function(e,f){var d=this,c=e;c.uiModel={alignment:""};b(c.model);if(!!c.alignment){if(c.alignment==="left"){c.uiModel.alignment="dropdown--left"}else{if(c.alignment==="right"){c.uiModel.alignment="dropdown--right"}}}d.onSelect=function(g){if(!!c.onClicked){c.onClicked({key:g})}}}])})(angular);(function(a){a.module("cmk.ui.lookup",["cmk.web.context","ngSanitize"]).directive("cmkLookup",["cmkWebContext","$timeout","$log",function(b,c,e){var d=b.staticResourcePath;return{restrict:"EA",transclude:true,require:["cmkLookup","^ngModel"],scope:{model:"=datasource",onChanged:"&onChanged",onLookup:"&onLookup",onSelRow:"&onSelRow",cssclass:"@",required:"@",alignment:"@",placeholder:"@placeholder",error:"@",width:"@",height:"@",layout:"@",icon:"@",columns:"@"},controller:"LookupController",template:function(){var f='<div class="lookup cm-lookup" data-select="single" data-scope="single" data-typeahead="true"><div class="form-element"><div class="lookup__control input-has-icon input-has-icon--right cm-input-lookup {{cssclass}}" ng-click="wantToLookup($event)"><svg aria-hidden="true" class="input__icon cm-input-icon"><use xlink:href="'+d+'/assets/icons/utility-sprite/svg/symbols.svg#search"></use></svg><input ng-model="model.selRow.value" ng-keyup="keyClicked($event)" ng-blur="onBlur()" data-id="{{model.selRow.key}}" class="input" required="required" ng-if="required == 1" type="text" aria-label="lookup" aria-haspopup="true" aria-autocomplete="list" role="combobox" value="{{model.selRow.value}}" placeholder="{{placeholder}}"/><input ng-model="model.selRow.value" ng-keyup="keyClicked($event)" ng-blur="onBlur()" data-id="{{model.selRow.key}}" class="input" ng-if="required == 0" type="text" aria-label="lookup" aria-haspopup="true" aria-autocomplete="list" role="combobox" value="{{model.selRow.value}}" placeholder="{{placeholder}}"/><span ng-if="required == 1" class="form-element__help">{{error}}</span></div></div><div class="lookup__menu cm-lookup-menu" ng-style="uiModel.lookupPostionStyle" ng-hide="uiModel.isHidden" role="listbox"><div ng-if="layout == 0" class="cm-lookup-ul" ng-mouseover="onMouseOver()" ng-mouseleave="onMouseLeave()"><ul ng-if="layout == 0" class="cm-lookup-list" role="presentation"><li class="lookup__item truncate" role="presentation" ng-repeat="row in model.rowset"><a href="#" role="option" data-id="{{row[uiModel.idField]}}"><svg aria-hidden="true" ng-if="icon !== undefined" class="icon icon-standard-account icon--small"><use xlink:href="'+d+'/assets/icons/standard-sprite/svg/symbols.svg#account"></use></svg><span ng-bind-html="row[uiModel.fields[0]]"></span></a></li></ul></div><div class="cm-lookup-table" ng-if="layout == 1" ng-mouseover="onMouseOver()" ng-mouseleave="onMouseLeave()" ><table ng-if="layout == 1" class="table table--bordered table--striped cm-table-border-no-top"><thead><tr class="text-heading--label"><th scope="col" ng-repeat="col in uiModel.fields" class="truncate"><span>{{col}}</span></th></tr></thead><tbody><tr ng-repeat="row in model.rowset" data-id="{{row[uiModel.idField]}}"><td ng-repeat="col in uiModel.fields" class="cm-truncate"><span ng-bind-html="row[col]"></span></td></tr></tbody></table></div></div></div>';return f},link:function(k,j,g,l){var i,f=k.layout==="1"?"div.cm-lookup-table":"div.cm-lookup-ul",h=(!!k.height)?k.height+"px":"300px";i=c(function(){j.find(f).slimScroll({position:"right",color:"#666",railColor:"#ccc",railVisible:true,size:"10px",height:h,alwaysVisible:true})},10);j.on("$destroy",function(){c.cancel(i)});j.on("click","table > tbody > tr",function(m){m.preventDefault();var n=a.element(this).attr("data-id");l[0].selectRow(n)});j.on("click","ul > li > a",function(m){m.preventDefault();var n=a.element(this).attr("data-id");l[0].selectRow(n)});l[0].setModelController(l[1]);k.$watch("model.selRow.value",function(n,m){if(n!=m){if(!k.model.selRow){k.model.selRow={key:"",value:""}}l[0].lookup(k.model.selRow.value)}})}}}]).controller("LookupController",["$scope","$log",function(i,j){var g=this,b=i,c,h={},k=(i.columns||"key,value").split(",");function d(){var l=b.model||{};h.isMouseOver=0;h.isHidden=true;h.required=b.required==="1"?"required":"";h.idField=k[0];h.fields=k.slice(1);h.alignment=b.alignment;h.width=b.width||"";h.isEmptyChanged=0;b.uiModel=h;if(!l.selRow||!l.selRow.value){l.selRow={key:"",value:""}}if(!l.rowset){l.rowset=[]}b.model=l}d();g.setModelController=function(l){c=l};function f(p){var l,m=k[0],o=b.model.rowset;for(var n=0;n<o.length;n++){if(o[n][m]==p){l=o[n];break}}return l||{}}g.selectRow=function(n){var m,l=f(n);b.$apply(function(){m=b.onSelRow({row:l})||l[k[1]];if(m.indexOf("&")!==-1){m=a.element("<span></span>").html(m).text()}b.model.selRow={key:l[k[0]],value:m};c.$setViewValue(b.model.selRow.key);h.isHidden=true;h.isMouseOver=0});h.isEmptyChanged=1;if(!!b.onChanged){b.onChanged()}};function e(){h.isEmptyChanged=0;b.model.selRow.key="";c.$setViewValue("");if(!!b.onChanged){b.onChanged()}}b.onBlur=function(){if(h.isMouseOver===0){h.isHidden=true}if(h.isEmptyChanged===1){if(!b.model.selRow.value){e()}}};g.lookup=function(l){if(!!b.onLookup){b.onLookup({keyword:l})}else{j.log("[Warning]: No on-lookup attribute is defined on the UI component.")}};b.keyClicked=function(l){switch(l.keyCode){case 27:h.isMouseOver=0;h.isHidden=true;break;case 13:h.isHidden=false;break}};b.wantToLookup=function(m){var l,o,n=a.element(m.currentTarget);m.preventDefault();h.isHidden=!h.isHidden;if(h.isHidden){return}o=n.width();l={top:n.height()+4,left:0};if(!h.alignment){l.width=o+"px"}else{if(h.alignment==="left"){if(!!h.width){l.width=h.width+"px"}}else{if(h.alignment==="right"){if(!!h.width){l.width=h.width+"px";if(parseInt(h.width)>o){l["margin-left"]=(o-parseInt(h.width))+"px"}}else{l.width=o+"px"}}}}h.lookupPostionStyle=l;n.find("input").select();g.lookup("")};b.onMouseOver=function(){h.isMouseOver=1};b.onMouseLeave=function(){h.isMouseOver=0}}])})(angular);(function(a){a.module("cmk.ui.pagelet",["cmk.web.context","ngSanitize"]).directive("cmkPagelet",["$timeout","$log","$window",function(b,c,d){return{restrict:"EA",transclude:true,scope:{model:"=options",onResize:"&onResize",onNavbarClick:"&navbarClick",onFooterLinkClick:"&footerClick"},require:["cmkPagelet"],controller:"PageletController",template:function(e,f){return'<article class="cm-article"><header class="clearfix"><div class="float-left"><h2 class="text-heading--label text-heading--large cm-article-title" ng-bind-html="uiModel.title"></h2></div><div class="float-right"><div class="cm-widget-hdr-group" ng-bind-html="uiModel.toolbarHTML"></div></div></header><div class="cm-article-body"><ng-transclude></ng-transclude></div><footer class="cm-article-footer" ng-if="!!uiModel.footerHTML" ng-bind-html="uiModel.footerHTML"></footer></article>'},link:function(i,h,f,j){var g,e="div.ui-grid-viewport";h.on("click","header a",function(l){l.preventDefault();var k=a.element(this).attr("href");if(k==="#_sys_expand"){j[0].resize(a.element(this));h.find(e).slimScroll({scrollTo:"0px",railVisible:true,alwaysVisible:true});h.find(e).focus()}else{i.onNavbarClick({href:k})}});g=b(function(){h.find(e).slimScroll({position:"right",color:"#666",railColor:"#ccc",railVisible:true,height:i.uiModel.height+"px",size:"10px",alwaysVisible:true})},10)}}}]).controller("PageletController",["$scope","$log","cmkWebContext",function(i,j,e){var f=this,c,b=i,g=b.uiModel={};function d(k){return['<a href="#',k.id,'" title="',k.text,'" class="button button--icon-border-filled cm-widget-hdr-button">','<svg aria-hidden="true" class="button__icon button__icon--small cm-icon">','<use xlink:href="',k.iconUrl,'"></use></svg><span class="assistive-text">',k.text,"</span></a>"].join("")}function h(){var k=b.model,l=[];g.title=k.title,g.height=k.height;k.navBars.forEach(function(m){l.push(d(m))});if(!!k.canExpand&&k.canExpand){l.push(d({id:"_sys_expand",text:"Zoom In & Out",iconUrl:e.staticResourcePath+"/assets/icons/utility-sprite/svg/symbols.svg#expand"}))}g.toolbarHTML=l.join("");g.footerHTML=k.footerHTML||""}h();f.resize=function(m){var l=a.element("body").hasClass("cm-body-full-screen");var k=g.height+50;var n=m.parents(".cm-col-container");n.toggleClass("cm-widget-full-screen");a.element("body").toggleClass("cm-body-full-screen");if(!l){k=n.height()-n.find("header").outerHeight(true)-n.find(".cm-article-footer").outerHeight(true)}n.find(".cm-article-body").height(k);if((n.find(".ui-grid-viewport").html()+"").length>0){n.find(".ui-grid-viewport").height(k-40).parent("div").height(k-40)}b.onResize({height:k})}}])})(angular);(function(a){a.module("cmk.ui.picklist",["cmk.web.context","ngSanitize"]).directive("cmkPicklist",["cmkWebContext","$log",function(b,d){var c=b.staticResourcePath;return{restrict:"EA",transclude:true,require:["cmkPicklist","^ngModel"],scope:{width:"=",alignment:"@",placeHolder:"@placeholder",onChanged:"&onChanged",model:"=datasource",cssclass:"@"},controller:"PickListController",template:function(){return'<div aria-expanded="{{uiModel.isHidden === false}}" class="picklist"><button class="button button--neutral picklist__label {{cssclass}} truncate" ng-blur="onBlur()" data-id="{{model.option.key}}" ng-click="wantToSelect($event)" aria-haspopup="true"><span ng-bind-html="model.option.value"></span><svg aria-hidden="true" class="icon"><use xlink:href="'+c+'/assets/icons/utility-sprite/svg/symbols.svg#down"></use></svg></button><div class="dropdown dropdown--small dropdown--menu {{uiModel.alignment}} cm-dropdown-menu" ng-hide="uiModel.isHidden"><ul class="dropdown__list" role="menu" ng-style="uiModel.lookupPostionStyle" ng-mouseover="onMouseOver()" ng-mouseleave="onMouseLeave()"><li ng-repeat="item in model.options" class="dropdown__item has-icon--left" aria-selected="{{item.selected}}" tabindex="-1" role="option"><a href="#" data-id="{{$index}}" class="truncate"><svg aria-hidden="true" ng-if="item.selected" class="icon icon--small icon--left"><use xlink:href="'+c+'/assets/icons/standard-sprite/svg/symbols.svg#task2"></use></svg><span ng-bind-html="item.value"></span></a></li></ul></div></div>'},link:function(g,f,e,h){f.on("click","a",function(j){j.preventDefault();var i=parseInt(a.element(this).attr("data-id"));h[0].onSelect(i,h[1])})}}}]).controller("PickListController",["$scope","$log",function(j,k){var h=this,d=0,c=j,g=j.model,e=!!c.width?c.width:200,i=c.uiModel={isHidden:true,alignment:"dropdown--left",lookupPostionStyle:{width:e}};if(!!c.alignment&&c.alignment==="right"){i.alignment="dropdown--right"}function f(){if(!g){g={option:{key:"",value:"Select ..."},options:[]};c.model=g;return}if(!g.option||!g.option.value){g.option={key:"",value:(!!c.placeHolder)?c.placeHolder:"Select ..."}}if(!g.options){g.options=[]}else{g.options.forEach(function(l){if(l.key===g.option.key){l.selected=true}else{l.selected=false}})}}f();c.wantToSelect=function(l){i.isHidden=!i.isHidden};function b(l){g.options.forEach(function(m){m.selected=false});i.isHidden=true;g.options[l]["selected"]=true;g.option=g.options[l];d=0}c.onBlur=function(){if(d===0){i.isHidden=true}};c.onMouseOver=function(){d=1};c.onMouseLeave=function(){d=0};h.onSelect=function(l,m){c.$apply(function(){b(l);m.$setViewValue(g.options[l].key);if(!!c.onChanged){c.onChanged()}})}}]);a.module("cmk.ui.pill",["cmk.web.context","ngSanitize"]).directive("cmkPill",["cmkWebContext","$log",function(b,d){var c=b.staticResourcePath;return{restrict:"EA",scope:{isHidden:"@isHidden",onRemove:"&onRemove",title:"@"},template:function(){return'<span ng-if="isHidden == 0"><span class="pill"><span class="pill__label" ng-bind-html="title"></span><button class="button button--icon-bare"><svg aria-hidden="true" class="button__icon"><use xlink:href="'+c+'/assets/icons/utility-sprite/svg/symbols.svg#close"></use></svg><span class="assistive-text">Remove</span></button></span></span>'},link:function(g,f,e){f.on("click","button",function(h){h.preventDefault();g.$apply(function(){g.onRemove()})})}}}])})(angular);