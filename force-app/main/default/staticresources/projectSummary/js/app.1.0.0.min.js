!function(e){"use strict";e.OHIMAGES=e.OHIMAGES||{},OHIMAGES.icon_check_green="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACsElEQVRIiaWVz08TQRTH558AGuIf0wvQ3VnwRwgSo0aBhBgSjaZeuPBmUGJADGDUk0aJIRqxlSMnIxG7M2tKC6gRaCtKClGLBbqxULrPg03ZQrsUOslc3ux+vjPzvvMeIQ7DLcFFde5VDO5XJPtODbauSpakgkVVnb2hOvfWT0K1E6PoqAtCLRXwnErYppKh84RtTYfRJr27piy4EmBnqcHWDwcXTlVAokFCiyNcDUAHlZA9KjwvIpmlGqyr5M5Vyazjwu0img7NhfCpvipVsp+Vwm15+aO8hRN5AU2H0UqhrcF+PGXc2osJeGrffboSeEd4BOc3l3Fs5R2e/ng77y63BBfxGOxmJfBLoSGMmWtoIWIoGcXWYP9ePgL8BqGSTxwX3hYexqi5hoiIX7dW8HJoaF/C+Wui6uybPahJhudnBrHR4IdeSywHX0zF8cLMYLG3ESOqZCl7kC+8wGTGRF/8Q0mRztkHBfBzwYHilhWQIFSwTXuwd/ElpnbTmLGy6F8NHBC5MvcQo7k7/7L1Ay+G7jnZ1SRUwrI92GhwHIj4MLWbxl0ri+PxaTyZs1/X3CNcSsXRQsT5zWVsCw8750mwBaIY3L9/odHg2L80nj/J+Oo0ej8/wYi5ihYizm7EsD10CFwyVAzuJ1Tn3mKLmmR4Z/EVmjmRZMZECxHDG1HsCN8vy2Wazq6RJr27RpVsp5TIQMSHW5m/iDmflwtXJdtRpvqqCCGE/K/9pT++G/Hh+8QnbA+PlP1GFKPnWb4WuSW4VAEJpx+ajN6y4aqAxIEG1CChpZJeYLNm9kC5zpdtA9oqbTgewTodu5qmQzOV8OvIAoL9pgE44wgvyIkOY6XctW/Xaar3PK4LQm1ZcPuon4Rqj+RXqeQTVLAFKsGkBlungkWpYD6PYNfdElxOjH/rAvhs8YLWZAAAAABJRU5ErkJggg==",OHIMAGES.icon_map_orange="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACbUlEQVRIiZ2Vz2sTQRTHB72pJf44VATBg1BBmpsK/gkirZdFs/veGBHUg1DxUgTBRtT2oCCUgqIgFooQBbtmZ2ZDrHjRg3+HhopKf0BB7I+vhzXdTXcmJg28Q8J77zPv+74zEdD0CormEXMFkb9PdPHBe3kAisdhqAlN72DOn3AnG9qAYSQhFxFzBS/Ke625VW8/Yr4HzctpzWZtZAXlExnQvIxYTrQmQjjUh8gfRcwL1vz2aKDmn8wDNC9D0xw0r7dPRC9h5KL9ILQGFUwhkvdzcMU1zAaDKSCSk0IIgdlgEDp43Q6yNl9C/cLpzYM2vAKMf6cNpGg+A+CHbdK1QG07ykRdnrXuqeEVoGmulecEpBL6Z6BpactCF52uEUJAybGuAUlBMLVlgj8Ih/q2DYApFVG/dDj9zh9yEsVc2RYA2r+e/EarUDyOOLjmdFDk30XoHe0N8LZ8BFFwA4pnuvB8a5oFKHmzM0DJx7mTRHIy0+gXFNcQBxqGVi2Xcx0hDbgBmr9C8W1E/ih06RwaXgFjYzug+BTq5WOoejs3wbEcttpXcdkNyMdPmFLRuUjDcV4qGukFAJjgidsp9NwywXhvAM0frc0bXgFGfrM4ay6ZLnjQJYDWYNjLyyOfuevoU/Y9+o9EDBjagKKrqTTlg1YXOaILAAOGP2eWe7nr+5EALFraPB7LYYSlfmj60hsgpAEoeuN8lt3QleTPiL53BKSX5+JxGJ7+t9hOjX9D01OEQ4eEEAK1K7sQ0wgMNTsCUo1LRetEmldg/EcIS/1W607z7uQVoB9Zg7juURbU7NQ4V1f19kDxLRhqQvHMX3js5QrQW72DAAAAAElFTkSuQmCC",OHIMAGES.icon_account_blue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAUCAYAAACXtf2DAAACQklEQVQ4ja2VTUgVURTHf1i7thZERBBEEG1tFS2iVUG0KVpFJaSlM/cOalAUvAiCqNZBuTGCwMBVUhAhtog+Xs2cc1UqgqBFKSVmWojlmxZ3fI69Z74nDtzFuXPO/3c5//sB1r3Aalr3MFoi0kss+61EvAxxj2oHGH1GlHRj3Vc/J78wrodQ+3M5QiS3sPqpfkBrsgmAQC9gNSV09wAopA1YHfeCQ02+xp2sHxAkuwAIk5vZagc43LuGjmIjRn76vPhQlnOxfoCV3xidXNxnmcboTG5uDiMTK/VgEiMOo6WcwHusjOVyPhBpsTwCd6B2QMvwDgCC5Lr3QB4C0CnrMDqFkbcU0oblBZcCtI1s8XFcyNpzH4BCYS1GJjAyWL94HmB0hFD7MDrlY5kl1H6MPM/iBUD7m4NE2rvsCOKu2g9aHmB0oMaa2QVAKEfplA2E2ud/JjFnXm7GDDVhZHYxQAazNr7DJlcxSZzpfCbUG+UFGC0tAE48XQ9AqGf9XHInt+LRqoDIHfFxcbevcecAOFXcWAmweheTtPutqSlGv2FcBza+VtmieUB8PvPxeAa4TSFtoE33VAPU4cF8izTFyvd/cn9gda4SECXdRK6VSIezwjECFxIll5cEGJ3BymusTGc5fzI/xisBHcVGAIK4KzvFPWXBUL9UB0gzAG3xfr9R4isAnH61vRJgpJmWeBtWH2Sxo1V20i57/T1VBRDIMQAi3ee7kD1AkW5dHQ/8xfcYo6PMvyFWnmDk4yqa/L8aLf0Fmm3g+bbIBCcAAAAASUVORK5CYII=",OHIMAGES.icon_refresh_blue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABe0lEQVQ4jZ2Sv0vDUBDHv0UR3VxE1MVFBMFBpKBT0cVBKF26CiIYC0nepX9BJi1OgpODi4hDdRe6FFRwqE3yLu3gJFKoP0DBSeoSh6TRmGChB295976f+97dA5IiXx4A3U5DNNIo1GZhmoORvGLPgLgD4nZUuHk1BnIPIOQriL3w6PwJck6g8jwAQDTSYS6MYn0Jgp8jQsEfQaXuXQckC3GAzot+Ffag8xM0RwFVR8N2NCsDwZVfoNoPIF8eAcl7EHswuIntu4nEucBLQee9iENiD9DkRmhPac7FdJqVgcElGFyCzsdxQNeakGeJhYmPYqIoQLYCwFYiQHPXA0j8GO4+wimrVja5915B3PYHaIv+AIZ74a9PXvbpwM6FA1Hra30QvBTIuQn+wTuKjZXEZ8Idh3BUmM2heHLHmYLgx2AbXyA+hWplodUWoMpV6PYuiN+CIofJRlRrEsK9/nfnQj6ArOUe7dg5kDyHkC3fjXyB4Ao0R4FZHf6r+Abn9BeFYDFN4QAAAABJRU5ErkJggg==",OHIMAGES.icon_target_blue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB+ElEQVQ4jZ1TzVIaQRD+LqTAn/cQUgUhVkXNe/AE6nKgdqZ3tTzzAEo0xGPwzhvEHHgAFtnu2a3yoMkl5gFMDhKwNocZFwnJJV3Vl+mvv6//BvjTgvglNL8DcQLin84TqLiDZlpZwufWTl8gkC40z0CS/dU1zxDEZ/CiwnIyyWcLkgeQvEeLt3DIqzjkVYSjbQTSBcnEYS4XSWwwA/E3hEkNXrSCQDzo+AI6voAv+2j0S/CHdWi+s1hz+rznGbQ8IExqaKYVaP66VH7AX0CjMlrRa1sJT0GjMuzAJHO9rcyTWeAbBd8oaDaO6BaNfgkUfwBJBiUnQCApSDL48RsE4uXJ7UERlL5CmNTQHhRzEjXeQzjadkM1AMk9SDI00jUo6VkyoxAmNZA8guQR2lQRjLVT/Yij63VX0f2c4Oh6/T8JOAFJhhZvwZf9vLT2oAhtqtCmavt2OM27oKudeQsq7tghStcC5TYPBmNtlZ+S5QaNfgnKnLu5HcOtbQaSCfxhHTQq5yQLVyg3OIg2oGQTmn+BeIqDaOPpFs6c6h38Yd2qjPegpAclPWjetW+yCZLvdhZxZ36JXlSAlkunNrF7vtpBI12z2xm/hTLnVlkykHxa/g9eVACZU3th//hMxFOouLOc/NyaaQVKTqDZQMsP62zgx8f2dBftNzTjoMmyOj48AAAAAElFTkSuQmCC",OHIMAGES.icon_person_blue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABEElEQVQ4jZ2SvUoDQRRGT1AiiOm0ygOJYJsH0EJSuDt3CSaW+wTiQ2ih4iMERVJGduYuCwHjTy0IGogp1yKokexm41441cx35oM7kDVNW8d35xj9QNw7omc0bT3z7tzs3W0h9gXR9A/GPdPqbxYLJD6dC3/j25NiQeCecgVGh0s00FGuQHRULDAuXtDAFQs87eQKvOioWBAmVURvM16/IUyqxQKAnYc1JBLEdRHXJYjMcuFGskEQNzF2F9LK70Fa4fB+G4n3OeivZ9QOVzFxC9G3mdqPGHs9RYczH+oViYTG5co03B7UENtbsLocbI/2oAbirv4f/uECfJ2UFvg6AXGfpQXGjSGwx6Ukxo3xtPMFiNxhcGqOfM4AAAAASUVORK5CYII=",OHIMAGES.icon_calendar_green="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAARCAYAAADUryzEAAABZUlEQVQ4jaWTsUpDQRBFp1G/R16prfp25qVI4S8E8gURNNmZVbSIJGCh5gf8DAXB7O5sWisRLEXEVKKmSCxCwAgR8rxwq5k9zL2wAD+Uq9sj5eGWdxvwS5UBb5LykLw05gbm4WzNpOY6BZcVkT2pTEhtl4LL5qy2SyqTIrKn4DKTmuu797wKpO5m+mh5Y5JrQJVxaYDKGEziI1LbK+Mi2MPfXS2vItiTshfkysdQNv/M84Aor6T8SMrvpDLBIE8Y5Gk653dSfpzuLADsKOcAAOi5gyovs5io8oKeOwAAO8r5QkDRb1UBAEyyF5TkLRv0VrJBb4WSvFHkcwCAot+qLo7w3w4w8CUlV6Motxj5w6jUjUodI39QlFtKroaBLxcCKne8DQBg1LYpyvOsA4rybNS2AQAqd7z91wVX5KVBSQao8kle9nN1B6T8hZETeWlg4Ks5AKqM/vEXRkCBT8tAUGVk1La/AdlsNPrXXN0bAAAAAElFTkSuQmCC",OHIMAGES.SVG_TEAM_MEMBER='<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path fill="#fff" d="m57 44h-12c-3.3 0-6 2.7-6 6v9c0 1.1 0.5 2.1 1.2 2.8 0.7 0.7 1.7 1.2 2.8 1.2v9c0 3.3 2.7 6 6 6h4c3.3 0 6-2.7 6-6v-9c1.1 0 2.1-0.4 2.8-1.2 0.7-0.7 1.2-1.7 1.2-2.8v-9c0-3.3-2.7-6-6-6z"></path><circle fill="#fff" cx="51" cy="33" r="7"></circle><path fill="#fff" d="m36.6 66.7c-0.2-0.2-0.5-0.4-0.7-0.6-1.9-2-3-4.5-3-7.1v-9c0-3.2 1.3-6.2 3.4-8.3 0.6-0.6 0.1-1.7-0.7-1.7h-9.6c-3.3 0-6 2.7-6 6v9c0 1.1 0.5 2.1 1.2 2.8 0.7 0.7 1.7 1.2 2.8 1.2v9c0 3.3 2.7 6 6 6h4c0.9 0 1.7-0.2 2.4-0.5 0.4-0.2 0.6-0.5 0.6-0.9v-5.1c0-0.3-0.1-0.6-0.4-0.8z"></path><circle fill="#fff" cx="32" cy="29" r="7"></circle><path fill="#fff" d="m76 40h-9.6c-0.9 0-1.3 1-0.7 1.7 2.1 2.2 3.4 5.1 3.4 8.3v9c0 2.6-1 5.1-3 7.1-0.2 0.2-0.4 0.4-0.7 0.6-0.2 0.2-0.4 0.5-0.4 0.8v5.1c0 0.4 0.2 0.8 0.6 0.9 0.7 0.3 1.5 0.5 2.4 0.5h4c3.3 0 6-2.7 6-6v-9c1.1 0 2.1-0.4 2.8-1.2 0.7-0.7 1.2-1.7 1.2-2.8v-9c0-3.3-2.7-6-6-6z"></path><circle fill="#fff" cx="70" cy="29" r="7"></circle></svg>',OHIMAGES.icon_team_member_blue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAArCAYAAAA+EwvfAAAFF0lEQVRoge2Z248URRSHK4Cg7GVuXdXsKGrAyGXZmT6ndkVBZbxEWQwrLjYz0+f0sg+EByT+CQZEEzEmxgR4UqPReNmgBBJDvLxoeDM+GBNBomElcTWSAAYxLGHAhwUcevpSszurkFjJeetzzu87dbq6qlqIiGEXyvdK8D5SSCcU0LhEOqKK/vaMdlNRPlMdaWc4rYre8xLpiAIaV8C/S+C9Oe0vbyqQ1P6zErimkC8FTSL/aPd5C1otXumNCxXST+E56UIOva1GgWwYejRK/FUD/laUSrNapr5UmqWQv4vLKYFruYL/cGIs6dChWPH/VKUcWYQCD1jAByz0j1voH1dA+y3010Y+D1w1zPlVvHrbb0us/mWzNL/e4O+6M6VDb0X52A6/KcS2GY0A/htGAMC1vN48N1K/tWggbxJowujjoL9C3pYMXn0uxG+faV5r0UA+EqC7252tkP4yCoT+q/W+aWc4beh7NriS2UXvNUOAs0JvvikSQAghbKQPTYJl9ND99X45XV1nWkW7wAP1vrJnw4NGRQN+P1a8EEJ0onuXRDodH8j/oAFc8yZjAM2bGgvHIwn9f0rpjQsTAYQQQi2rrJBIY6HJkUfCXiTZ660xBchidXXQP683z5XAe8PF0y9qWWWFkfiro9ttzzn+MzbyiAQ+aDm8Jw3VVZHPT6xgpxKrD3QybiWZpzc8ZDm8RwIftJFHlK5uEd1ue3PiJzly6G1NnAFd3fKviJnsyGlvR9i3RALXVNHfPr3Zbb8tC+5SCz0dZWlnOJ0UJu24jkTaLR06JB06JNHbpaBcTPLrvM/NxuXOgrtU2H5bg2Ner7WUQ+8o4HOJLeDwZ5MsT+KQQF8m5gc+JzW/fes9QzkhxMQHyEb/sMnqIYFrOV1dN10ACr1BCXTR8JvwfUa7KaGK/iumy18OvRej0/fPyfZV5tt93oI4y/ZV5gvRPycSogk9llPdKRTyz0YODv0Wtpx16PWLLeADEvm8aWKJfF4B7bcKvCgYL6PdlEI6YRQLaFSY7j5tzS8Fk11+Wf8wFd4IQqfDXm7TWZDANWGaLLj3EUIIifTNZMVfLQzw1w2FgeoqU39jgHZwZbB1pir+inUUh+6uj922rGq3FEAC14IHEVX0Hm8VgNLlx66dg20zTFvbDADpQkP7NLF5S4zf660Jac8L/wPcEAAS6MyNCiCBzggFtP9GBVDI+0TXksE7kvZC1yOA1PxDXg/dLoQQ4s7S8M1ZrK6OOgtLoIvCdWfWJ5jXy6VWAczr5dI16l13ZtSmTiKdzmh+InRbHXUOVth4H5PRbkoB/znl6gOdEcv7O+tjz9XcFdMNYw3CTQBkkTcEn7ccj4zOEFEGNG45HgXjZqHydMsBbIc/CfNReuPCnPZ2NCs+5/gvdOj1i0NjxtzUTRpAIV+yC5VHwvxSmrFZgJRmDNVQ4AfiDjVTApDIv04cSKYH4JbC4G3JGqYAcLlvR4MvXSsArJUDHQq8Y0l+sQAKaNQkeReWl7QaoAvLS4x8gUbjZuDT6x1AAh+MngH0Bq93ALun/GQkgBBmd/XB5c/W1NMsgK2ppz6GyQkv+E8ifiaAvpBIYzbQySsmgY5K9HY1/GRY3t/ZzK2EAhq3Vg501Ifo7nZnS6TdEujoNTmRxhR4n+eKlaeMxE92KE3vNTED706rmMmMdnClRDqS2DroH87rtdZ/rTd0ZLSbspBeVuAdqz+US+CaAu+Y5VR3tvpP/9+Yzcth2H4yoQAAAABJRU5ErkJggg==",OHIMAGES.icon_cancel_location_blue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAWCAYAAAArdgcFAAADW0lEQVQ4jZ3TT2wUdRQH8G/dmXW3W2tpZ36za8EsiGi70J3fWxNDPLgHNCbexEnZ/f1GFmO00YsX0lg1VmV3GsQ/gMYWD8ajxqSJgQYDUg7+Q4ORoDEmDQSRKCgY0ISq1eelO93tbivtS95l5s3nzbz3G2CZMRxDuhzBaBDB2cAEV0z8MGJi3zMxrF6uCQAIDGwKDFwJTHBDGvgjMHDfsuAdcayqGLg82nMr7+4Wc2i0hd+5604OTHDFwO9BDGuQdEtpJ6c2XCtejmBPYILHt3h8/sTX/FrK4sAEf7H7Vf7u/ffCZiMm9sGR6pIgzcL1j1luUWUyXrQZms6XYp1U2PZUvHW6Ckw89gj/9NVxPv7mGzw1cYB3tl1fO6IzEKS5Ll31s5PTI13rvG4ASKwvOF3Z4qAt1TlBmp+PmXUzPn34EM9MT/OelU7d9YqBqyHukNovSI/bpGYEaRZST1vkHxFS/VnbfHtbewh8Un6RT390mI8+O8Q/fvYpv9x5Q+1YToV4hyzcDQBJt5S2SL9kS/1bw1eR5kJy3aXABB98YoDPHJ3kXTe2cmCCJ4cG+dSHB0O8HMHrDXgYjp8QpIfDL5nN7JpND5cNXNx7c4p3dSTqRjF6+9rqSK48DXQvjM+GLdVELe6Q/+gLwMaKgQvNzvlz8Shva19VAIB5+PB1wtXbhatfSVF/TyJTSoanqWbhyd6tmSHACaIYqZg4UTZwsWLim8039fLqDZu5nby1jXg+b1hu8S3LVZOC9FUh9flmc7dJzQjXPyZIj6WovwcAOtxSR/V+A955R+Ge2nGIXOFxm/RfNqnLFvlHBOkxR+ovGxvpKQAti+J2Tp0VsnhIkB533MKTmYwXTedLsboFeF7EkvqD+Q3abvHFonhDSjXabMGdcsuD82tX9Pnrl4p/2/T0UPHt+bVWVg205nTq2nHS7Ei9Fxu9+Bys+psuWOp/BKlfloQL0tzl+jvCJZP+/P/q6/EFjtvcW6lzVp++bUVO329L9e+S8HjfAystUjsbfpaFmpGe6soWBx1S79qk/l4Ur0Y6X4oJWXxIkD7ZFHXVx3bO9+B5keozs0scFqR/XRSviRaR67/XIbVfSH1BkB5L9m7NLFQMAHD8hJVVA4L0STunv0fGawOA/wBU1z2DNI3gxwAAAABJRU5ErkJggg==",OHIMAGES.icon_clock_blue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACsElEQVRIiaWVO08UURTHbwvLiuzcxy5LYcXb2bnnEhJDYVAKJboFZICZe+6GhsfCdzCUWtoYMbHxKwhYKFhI/AighmhpjAXPxrBEC9ndO8s+JuEmU+zNmf/v/P97JoeQJqfNnepxPLPKJL4TYPa5xDMu8UyA2WdSb3EVrLS5Uz3NNOqeDukzkQufM9DnHPBvs4dJvKAyfNOuMBNLnOb0Iwb6uJXwFRDoYzYSTjYV5ypYYaBLkZdl+F54eiGppvuJMAkiTCKppvsFmEUOuF0DKXEVFht3LvGial1/uymDu60cp9XMOAM8sCFXnNC+fLcdCwP8dOOOn4qVKSEkO1pwmKd3LchRYmg+XY0GzCu783ri1DVzDHSJgS5R18zVhVhOuNQvCSH/R9GelkaxcMA1K++1ejWOa+5ZLs6dXj9LHM+sWtQPjWKIAyCEEApmp1KnwiJhUm+VL4SnF64PwKWKHugNwhR+LV9QF/uuC0iq6f4qwOwTBnhSAYzlk3EA1AueNXQwlk9a03gSG0BV8KTqQP/ucs1wTID+EieiLtcMM9BH1YHAXynpD9bWZWB2IBKR8HDTulhsBCCEkPRIOGpDGODP2qZoTi9XGgbzNjqmgNvNAPUgQprXEYCnP0bGtPZDS6uZ8dgQGf5Ie/O3yvdCFibsD4325bsJIYRwwHXL9kF2tOC0gji9frbzdthV/t2tHlOu8Ht10vBFpbhdYSaSrad340Ai4jL8bC2hw8RwICJFbCSctHcBAzwQ7tz9VuJCFibszhnoEpP6Yd1irsJi7cKhYHYo4FIGZgfIkN9BhvyOlPQHKeBS5A+9FKc5vdy0o0snR/aLsVamxMMUBA9iZyoUPuVS/4mxi8854HpkwcQ9Tq+f5SosCg83qcQ9JvUpk/qUStwToDdoTi9XRrHB+QfvD7DEmvYubgAAAABJRU5ErkJggg=="}(window),function(e){"use strict";function t(){return h++,["chart",h].join("_")}function o(){this.instances={}}function n(e,t){OH.charts.instances[e]={canvas:t,dataUrl:void 0}}function i(e,t){OH.amCharts[e]=t}function a(e,t){e=document.createElementNS("http://www.w3.org/2000/svg",e);for(var o in t)e.setAttributeNS(null,o.replace(/[A-Z]/g,function(e,t,o,n){return"-"+e.toLowerCase()}),t[o]);return e}function l(e){var t=new fabric.Rect({top:e.top,left:e.left,lockMovementX:!0,lockMovementY:!0,editable:!1,width:e.width,height:e.height,lockScalingX:!0,lockScalingY:!0,selectable:!1,fill:e.fill});return e.strokeWidth&&(t.strokeWidth=e.strokeWidth,t.stroke=e.stroke||e.fill,t.strokeLineJoin=e.strokeLineJoin||"round"),t}function r(e){return new fabric.Textbox(e.content+"",{fontSize:e.fontSize||13,fontWeight:e.fontWeight||400,fontFamily:"Salesforce Sans",lockMovementX:!0,lockMovementY:!0,editable:!1,textAlign:e.textAlign||"left",width:e.width,lockScalingX:!0,lockScalingY:!0,strokeWidth:e.strokeWidth||.25,stroke:e.stroke||e.fill,fill:e.fill,lockUnitScaling:!0,top:e.top,left:e.left,selectable:!1})}function c(e,t){var o,n,i,a,c,d=new fabric.Canvas(e);return d.lockUnitScaling=!0,d.setHeight(t.height),d.setWidth(t.width),t.boxes.forEach(function(e){switch(c=e.top||0,n=t.fontSize||e.fontSize||13,a=l({top:c,left:e.left,width:e.width,height:e.height-c-10,fill:e.backgroundColor,strokeWidth:e.strokeWidth||10}),d.add(a),e.verticalAlign){case"middle":o=Math.round((e.height+e.top-n)/2);break;case"bottom":o=e.top+e.height-n-10;break;default:o=10}i=r({top:o,left:e.left,fontSize:t.fontSize||e.fontSize,fontWeight:t.fontWeight||e.fontWeight,textAlign:t.textAlign||e.textAlign,fill:t.fontColor||e.fontColor,width:e.width,content:e.content}),d.add(i),e.title&&(i=r({top:0,left:e.left,fontSize:t.titleFontSize||e.titleFontSize,fontWeight:t.fontWeight||e.fontWeight,textAlign:t.textAlign||e.textAlign,fill:e.fill,width:e.width,content:e.title}),d.add(i))}),t.callback&&t.callback(d),d}function d(e,t){var o,n,i,a,l,c=new fabric.Canvas(e);switch(c.lockUnitScaling=!0,c.setHeight(t.height),c.setWidth(t.width),l=t.paddingTop||0,a=l||0,i=new fabric.Rect({top:l,left:0,lockMovementX:!0,lockMovementY:!0,editable:!1,width:t.width-10,height:t.height-10-a,strokeLineJoin:"round",strokeWidth:10,stroke:!!t.borderColor||t.backgroundColor,lockScalingX:!0,lockScalingY:!0,selectable:!1,fillAlphas:1,fill:t.backgroundColor}),t.verticalAlign){case"middle":o=(t.height+a-t.fontSize)/2;break;case"bottom":o=t.height-t.fontSize-10;break;default:o=t.y||10}return n=r({content:t.textContent+"",fontSize:t.fontSize,fontWeight:t.fontWeight,width:t.width-10,height:t.height-10,textAlign:t.textAlign,fill:t.fontColor,top:o,left:0}),c.add(i),c.add(n),t.callback&&t.callback(c),c}function s(e,t){var o,n,i,l,r;r=a("g"),i=a("svg",{width:t.width,height:t.height}),i.appendChild(r),o=a("rect",{x:0,y:0,width:t.width,height:t.height,rx:5,ry:5,fill:t.backgroundColor}),r.appendChild(o),n=a("text",{x:t.textX,y:t.textY,textAnchor:t.textAlignment,fill:t.fontColor,fontSize:t.fontSize,fontWeight:t.fontWeight}),n.textContent=t.textContent,r.appendChild(n),l=document.getElementById(e),l.appendChild(i)}function u(){this.charts=new o,this.amCharts={},this.colors={green:"#4bca81",orange:"#ffb75d",blue:"#0070d2",blue900:"#1A237E",blue800:"#283593",blue700:"#303F9F",blue600:"#3949AB",blue500:"#3F51B5",blue400:"#5C6BC0",blue300:"#7986CB",blue200:"#9FA8DA",blue100:"#C5CAE9",lightBlue400:"#29B6F6",lightBlue500:"#03A9F4",lightBlue600:"#039BE5",lightBlue700:"#0288D1",lightBlue800:"#0277BD",lightBlue900:"#01579B",grey200:"#F5F5F5",grey300:"#E0E0E0",grey400:"#BDBDBD",grey500:"#9E9E9E",grey600:"#757575",grey700:"#616161",grey800:"#424242",grey900:"#212121",label:"#54698d",activeLabel:"#16325c",white:"#ffffff",black:"#333333",secondaryBlack:"#888888",hintText:"#AAAAAA",red900:"#B71C1C",red800:"#C62828",red700:"#D32F2F",red600:"#E53935",red500:"#F44336",red400:"#EF5350",red300:"#E57373",red200:"#EF9A9A",red100:"#FFCDD2",azure:"#1589ee",scienceBlue:"#0070d2"}}var h=0;o.prototype.makeLineAreaChart=function(e,t){var o,n,a,l,r=t.data||[];n=r.length>0?moment(r[0].date):void 0,a=n?n.format("DD"):"",l=n?n.format("MMM"):"",o=AmCharts.makeChart(e,{type:"serial",theme:"light",color:t.color,dataProvider:r,balloon:{cornerRadius:6,horizontalPadding:15,verticalPadding:10},valueAxes:[{title:t.valueTitle,axisAlpha:0,labelsEnabled:!1,gridThickness:0}],graphs:[{balloonText:t.balloonText||"[[value]]",bullet:"round",bulletBorderAlpha:1,bulletBorderThickness:1,fillAlphas:t.fillAlphas||1,fillColors:t.fill,legendValueText:"[[value]]",lineColor:t.lineColor,lineThickness:t.lineThickness||4,title:"duration",valueField:"duration",labelText:"[[value]]"}],chartCursor:{categoryBalloonDateFormat:"YYYY MMM DD",cursorAlpha:0,fullWidth:!0},dataDateFormat:"YYYY-MM-DD",categoryField:"date",categoryAxis:{dateFormats:[{period:"DD",format:"DD"},{period:"WW",format:"MMM DD"},{period:"MM",format:"MMM"},{period:"YYYY",format:"YYYY"}],parseDates:!0,autoGridCount:!0,axisColor:"#fff",gridAlpha:0,gridCount:50,gridThickness:0,labelFunction:function(e){return a&&a==e?[l,e].join(" "):e}},export:{enabled:!0,menu:[],libs:{autoLoad:!1}}}),i(e,o)},o.prototype.makePieChart=function(e,t){var o,n=t.data||[],a=new AmCharts.AmPieChart;a.startAngle=185,a.radius=t.radius,a.innerRadius=t.innerRadius,a.labelsEnabled=!1,a.pullOutEffect="easeInSine",a.pullOutDuration=0,a.startEffect="easeInSine",a.startDuration=0,a.titleField="title",a.valueField="value",a.theme="light",a.colorField="color",a.creditsPosition="bottom-right",a.percentPrecision=t.percentPrecision||0,a.precision=t.precision||0,a.balloonText=t.balloonText||"[[title]]<br><span style='font-size:14px'><b>[[value]]</b> ([[percents]]%)</span>",a.export={enabled:!0,menu:[],libs:{autoLoad:!1}},n.forEach(function(e){}),a.dataProvider=n,t.title&&(a.allLabels=[{align:"center",y:t.title.top,size:t.title.fontSize,bold:!0,color:t.title.color,text:t.title.content},{align:"center",y:t.subTitle.top,size:t.subTitle.fontSize,bold:!1,color:t.subTitle.color,text:t.subTitle.content}]),t.legend&&(o=new AmCharts.AmLegend,o.align="left",o.color=t.legend.color,o.enabled=t.legend.enabled,o.left=t.legend.left,o.position=t.legend.position,o.valueAlign=t.legend.valueAlign,o.labelText="[[title]]",o.right=t.legend.right,o.valueText="([[percents]]% - [[value]])",a.addLegend(o)),a.write(e),a.invalidateSize(),i(e,a)},o.prototype.makeBarChart=function(e,o){var n,a,l,r,c=new AmCharts.AmSerialChart;c.rotate=o.rotate||!1,c.categoryField="category",c.startAlpha=0,c.theme="light",c.marginLeft=o.marginLeft||0,c.color=o.color||OH.colors.label,c.gridThickness=o.gridThickness||0,c.dataProvider=o.data,l=o.data.length>5?50:100,c.export={enabled:!0,menu:[],libs:{autoLoad:!1}},o.categoryAxis&&(r=c.categoryAxis,n=o.categoryAxis,r.autoGridCount=!0,r.autoWrap=n.textWrap||!1,r.ignoreAxisWidth=n.textWrap||!1,r.axisColor=n.hidden?OH.colors.white:n.color||OH.colors.black,r.gridPosition=n.gridPosition||"start",r.gridThickness=n.gridThickness||0,r.axisThickness=n.thickness||1,r.labelFunction=n.labelFunction||function(e,t,o){return e.length>l?e.substring(0,l)+"...":e}),a=new AmCharts.AmGraph,a.id=t(),a.bulletSize=14,a.colorField="color",a.color=o.labelColor||OH.colors.black,a.fillAlphas=1,a.lineAlpha=0,a.labelText=o.labelText||"[[value]]",a.labelPosition=o.labelPosition||"top",a.type="column",a.valueField="value",c.addGraph(a),o.legend,o.valueAxis&&(n=o.valueAxis,r=new AmCharts.ValueAxis,r.id=t(),n.hidden&&(r.axisAlpha=0,r.labelsEnabled=!1),r.gridThickness=n.gridThickness||0,r.autoWrap=!0,(n.minimum||0===n.minimum)&&(r.minimum=0),n.maximum&&(r.maximum=n.maximum),r.axisColor=n.color||OH.colors.black,r.color=n.labelColor||OH.colors.black,r.axisThickness=n.thickness||1,n.labelFunction?r.labelFunction=n.labelFunction:r.labelFunction=function(e){return e?e+"%":e},c.addValueAxis(r)),c.write(e),c.invalidateSize(),i(e,c)},o.prototype.makeGaugeChart=function(e,t){var o=AmCharts.makeChart(e,{type:"gauge",theme:"light",autoDisplay:!0,autoResize:!0,creditsPosition:"bottom-right",axes:[{axisAlpha:0,tickAlpha:0,labelsEnabled:!1,startValue:0,endValue:100,startAngle:0,endAngle:270,bands:[{color:"#eee",startValue:0,endValue:100,radius:"100%",innerRadius:"85%"},{color:t.band1.color,startValue:0,endValue:t.band1.value,radius:"100%",innerRadius:"85%",balloonText:t.band1.tip},{color:"#eee",startValue:0,endValue:100,radius:"80%",innerRadius:"65%"},{color:t.band2.color,startValue:0,endValue:t.band2.value,radius:"80%",innerRadius:"65%",balloonText:t.band2.tip}]}],allLabels:[{text:t.band1.label,x:"49%",y:40,size:13,color:"#16325c",align:"right"},{text:t.band2.label,x:"49%",y:65,size:13,color:"#16325c",align:"right"},{align:"left",id:"Label-1",rotation:0,color:"rgb(75, 202, 129)",size:40,bold:!0,text:t.title,x:65,y:120},{align:"left",id:"Label-2",rotation:0,color:"rgb(75, 202, 129)",size:13,text:t.subTitle,x:90,y:170}],export:{enabled:!0,menu:[],libs:{autoLoad:!1}}});i(e,o)},o.prototype.drawCircle=function(e,t){e.add(new fabric.Circle({top:t.top,left:t.left,fill:t.fill,stroke:t.borderColor,strokeWidth:t.borderWidth,radius:t.radius}))},o.prototype.drawTextbox=function(e,t){e.add(r(t))},o.prototype.makeTimeline=function(e,t){var o,i,a,l,r=new fabric.Canvas(e),c=t.width,d=0,s=Math.round(t.height/2),u=s-12,h=d,g=t.width/100,f=t.data,A=0,m=f[f.length-1];r.lockUnitScaling=!0,r.setHeight(t.height),r.setWidth(c),o=new fabric.Rect({top:s,left:d+1,lockMovementX:!0,lockMovementY:!0,editable:!1,width:c-4,height:4,lockScalingX:!0,lockScalingY:!0,selectable:!1,fill:t.backgroundColor}),r.add(o),l="left",f.forEach(function(e){i=e.color==OH.colors.orange?e.color:"#54698d",h=g*e.value,A=m.value===e.value?1:0,A?(a=t.width-104,h=t.width-26,l="right"):a=h,r.add(new fabric.Circle({top:u,left:h,fill:e.color,height:15,width:10,radius:12,selectable:!1,editable:!1,lockScalingX:!0,lockScalingY:!0})),r.add(new fabric.Textbox(e.label,{fontSize:12,fontWeight:400,fontFamily:"Salesforce Sans",lockMovementX:!0,lockMovementY:!0,editable:!1,textAlign:l,width:100,lockScalingX:!0,lockScalingY:!0,strokeWidth:.25,stroke:i,fill:i,lockUnitScaling:!0,top:u+30,left:a,selectable:!1})),r.add(new fabric.Textbox(e.data,{fontSize:10,fontWeight:400,fontFamily:"Salesforce Sans",lockMovementX:!0,lockMovementY:!0,editable:!1,textAlign:l,width:100,lockScalingX:!0,lockScalingY:!0,strokeWidth:.25,stroke:i,fill:i,lockUnitScaling:!0,top:u+48,left:a,selectable:!1}))}),n(e,r)},o.prototype.makeChartLegend=function(e,t){var o,i,a,c,d,s,u=new fabric.Canvas(e);u.setWidth(t.width),u.setHeight(t.height),s=t.top,t.svgIconId?(fabric.loadSVGFromString(OHIMAGES[t.svgIconId],function(e,t){t.scaleX=.5,t.scaleY=.5,t.top=30,t.left=0,e.forEach(function(e){e.fill=OH.colors.green});var o=fabric.util.groupSVGElements(e,t);u.add(o)}),a=50):a=0,c=r({fontSize:t.titleFontSize,fontWeight:700,textAlign:"left",width:200,fill:OH.colors.green,top:s,left:a,content:t.title||"No Title"}),u.add(c),s+=t.titleBottomGap||40,i=t.legendGap||20,d=t.squareSize||15,t.data.forEach(function(e){o=l({left:0,top:s,fill:e.color,height:d,width:d}),u.add(o),c=r({fontSize:t.labelFontSize,fontWeight:400,textAlign:"left",left:30,top:s,fill:t.color||e.color,content:e.label,width:200}),u.add(c),s+=i}),t.callback&&t.callback(u),n(e,u)},o.prototype.makeManyTextboxes=function(e,t){return t?void(this.instances[e]={dataUrl:void 0,canvas:c(e,t)}):void console.log("configs is required for makeTextbloxes.")},o.prototype.makeTextbox=function(e,t){return t?void(t.useSvg?s(e,t):this.instances[e]={dataUrl:void 0,canvas:d(e,t)}):void console.log("configs is required for makeTextblox.")},u.prototype.toPDF=function(){OHPDF.create()},u.prototype.svgToCanvas=function(e){var t=document.getElementById(e).innerHTML,o=document.createElement("canvas"),n=new fabric.Canvas(o);n.lockUnitScaling=!0,n.setHeight(100),n.setWidth(532),fabric.loadSVGFromString(t,function(t,o){console.log(t),t.forEach(function(e){switch(e.type){case"line":e.left=532*e.x1/100,e.x1=532*e.x1/100,e.x2=532*e.x2/100,e.width=e.x2-e.x1,e.strokeWidth=.5;break;case"text":e.fontSize=10;break;case"circle":e.radius=5}});var i=fabric.util.groupSVGElements(t,o);n.add(i).renderAll(),OH.charts.instances[e]={canvas:n,dataUrl:void 0}})},u.prototype.initImages=function(){var e=document.getElementById("ohExecutionImg");e.src=OHIMAGES.icon_check_green,e=document.getElementById("ohLocationsImg"),e.src=OHIMAGES.icon_map_orange,e=document.getElementById("ohAccountsImg"),e.src=OHIMAGES.icon_account_blue,e=document.getElementById("ohProjectCycleImg"),e.src=OHIMAGES.icon_refresh_blue,e=document.getElementById("ohProgramNameImg"),e.src=OHIMAGES.icon_target_blue,e=document.getElementById("ohProjectOwnerImg"),e.src=OHIMAGES.icon_person_blue,e=document.getElementById("ohProjectBuilderImg"),e.src=OHIMAGES.icon_person_blue,e=document.getElementById("locationsExecutedByDayImage"),e.src=OHIMAGES.icon_calendar_green},u.prototype.onReady=function(){function t(e){if(!n&&("readystatechange"!==e.type||"complete"===document.readyState)){for(var t=0;t<o.length;t++)o[t].call(document);n=1,o=null}}var o=[],n=0;return document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),document.addEventListener("readystatechange",t,!1),e.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",t),e.attachEvent("onload",t)),function(e){n?e.call(document):o.push(e)}}(),u.prototype.onLoad=function(t){document.addEventListener?e.addEventListener("load",t,!1):document.attachEvent&&e.attachEvent("onload",t)},e.OH=e.OH||new u}(window),function(e){"use strict";function t(){function t(e){d.content.push(e)}function n(e){return{canvas:[{type:"line",x1:e.left||0,y1:e.top||0,x2:e.width||554,y2:e.top||0,color:e.color||OH.color.label,lineWidth:.5}]}}function i(e,o){t(n({top:e,color:o}))}function a(){function e(e){var t={};for(var o in e)t[o]=e[o];return t}var t={},o="0",i={},a=[],l=[];return i.alignment="justify",t.newInstance=function(){return a=[],i={},l=[],o="0",t},t.alignment=function(e){return i.alignment=e,t},t.width=function(e){return i.width=e,t},t.height=function(e){return i.height=e,t},t.margin=function(e){return i.margin=e,t},t.addObject=function(e){return t["add"+o](e),t},t.addText=function(n,i){var a=e(i);return a.text=n,t["add"+o](a),t},t.addImage=function(n,i){var a=e(i);return a.image=n,t["add"+o](a),t},t.addLine=function(e){var i=n({left:e.left,top:e.top,color:e.color});return t["add"+o](i),t},t.addGap=function(e){var i=n({left:e.left,top:e.top,width:e.width,color:OH.colors.white});return t["add"+o](i),t},t.add0=function(e){a.push(e)},t.add1=function(e){l.push(e)},t.beginColumns=function(){return o="1",l=[],t},t.endColumns=function(){return a.push({columnGap:5,columns:l}),l=[],o="0",t},t.toContent=function(){return i.stack=a,i},t}function l(){var e=document.getElementById("ohBusyIndicator");e.classList.toggle("cmk-hide")}function r(){function e(){return a==n?void(t=setTimeout(function(){c.toPDF(),t&&clearTimeout(t)},10)):(o=r[a],a++,i=OH.amCharts[o],i.exportedImage?void e():void i.export.capture({},function(){this.toPNG({},function(t){this.setup.chart.exportedImage=t,e()})}))}var t,o,n,i,a=0,r=[];l();for(o in OH.amCharts)r.push(o);n=r.length,e()}var c={},d={content:[],pageSize:"A4",pageOrientation:"portrait",pageMargins:[20,30,20,30]};return c.createLayout=function(){return d.content=[],c},c.pngifyCanvasElements=function(){var e;for(var t in OH.charts.instances)e=OH.charts.instances[t],e.dataUrl=e.canvas.toDataURL({format:"png"});return c},c.addPageTitle=function(){return t({text:document.getElementById("pageTitle").innerHTML,fontSize:o.xlarge,color:OH.colors.azure}),i(4,OH.colors.white),t({text:document.getElementById("pageSubTitle").innerHTML,fontSize:o.xsmall,color:OH.colors.label}),i(8,OH.colors.azure),c},c.addSummary=function(){var e,n=[],l=160,r=80;return i(20,"#fff"),e=new a,e.width("33%").margin([40,0,0,0]).beginColumns().addImage(OHIMAGES.icon_check_green,{width:12,height:12,alignment:"right"}).addText("Execution",{alignment:"left",width:"*",color:"#4bca81s",fontSize:o.normal,bold:"700"}).endColumns(),n.push(e.toContent()),e=e.newInstance(),e.width("33%").margin([40,0,0,0]).beginColumns().addImage(OHIMAGES.icon_map_orange,{width:12,height:12,alignment:"right"}).addText("Locations",{width:"*",alignment:"left",color:"#ffb75d",bold:"700"}).endColumns(),n.push(e.toContent()),e=e.newInstance(),e.width("33%").margin([50,0,0,0]).beginColumns().addImage(OHIMAGES.icon_account_blue,{width:12,height:12,alignment:"right"}).addText("Accounts",{width:"auto",alignment:"left",color:"#0070d2",bold:"700"}).endColumns(),n.push(e.toContent()),t({margin:10,columns:n,columnGap:5}),n=[],n.push({width:"33%",image:OH.charts.instances.ohExecution.dataUrl,fit:[l,r]}),n.push({width:"33%",image:OH.charts.instances.ohLocations.dataUrl,fit:[l,r]}),e=e.newInstance(),e.width("33%").addObject({image:OH.charts.instances.ohAccounts.dataUrl,fit:[l,r]}).addGap({top:10,width:200}).beginColumns().addImage(OHIMAGES.icon_refresh_blue,{width:8,height:8}).addText(document.getElementById("ohProjectCycle").innerHTML,{color:"#54698d",alignment:"left",fontSize:o.xsmall}).addImage(OHIMAGES.icon_target_blue,{width:8,height:8}).addText(document.getElementById("ohProgramName").innerHTML,{color:"#54698d",alignment:"left",fontSize:o.xsmall}).endColumns().addGap({top:10,width:200}).beginColumns().addImage(OHIMAGES.icon_person_blue,{width:8,height:8}).addText(document.getElementById("ohProjectOwner").innerText,{color:"#54698d",alignment:"left",fontSize:o.xsmall}).addImage(OHIMAGES.icon_person_blue,{width:8,height:8}).addText(document.getElementById("ohProjectBuilder").innerText,{color:"#54698d",alignment:"left",fontSize:o.xsmall}).endColumns(),n.push(e.toContent()),t({columns:n,columnGap:20,alignment:"justify"}),c},c.addDisclaimer=function(){return i(10,OH.colors.white),t({text:document.getElementById("ohDisclaimer").innerText,fontSize:o.small,color:OH.colors.hintText}),i(10,OH.colors.white),c},c.addProjectTimeline=function(){return i(10,"#fff"),t({stack:[{image:OH.charts.instances.projectTimeline.dataUrl,fit:[542,100]}],margin:[0,0,0,0]}),c},c.addExecutedLocationsByDay=function(){var e=new a;return i(30,"#fff"),t(e.margin([180,0,0,0]).beginColumns().addImage(OHIMAGES.icon_calendar_green,{width:12,height:14}).addText("Executed Locations By Day",{width:"*",alignment:"left",fontSize:o.large,color:OH.colors.green}).endColumns().toContent()),i(8,OH.colors.green),i(15,OH.colors.white),t({image:OH.amCharts.chartExecutedLocationsByDay.exportedImage,fit:[523,200]}),c},c.addPageBreak=function(){return t({canvas:[{type:"line",x1:0,y1:0,x2:554,y2:0,color:OH.colors.white,lineWidth:.5}],pageBreak:"after"}),c},c.addServiceTitle=function(e,n){return t({text:e,fontSize:o.large,color:OH.colors.azure}),t({text:n,fontSize:o.xsmall,color:OH.colors.label}),i(4,OH.colors.azure),c},c.addServiceSummary=function(e){var n=[],l=new a,r=12,d=12;return n.push(l.width("66%").height(200).addText(document.getElementById("serviceObjectiveLabel_"+e.id).innerHTML||"",{alignment:"left",color:OH.colors.azure,fontSize:o.normal}).addGap({top:5,width:200}).addText(document.getElementById("serviceObjective_"+e.id).innerText||"",{alignment:"left",color:OH.colors.hintText,fontSize:o.small}).toContent()),l=l.newInstance(),n.push(l.width("33%").height(200).addGap({top:5,width:200}).beginColumns().addImage(OHIMAGES.icon_cancel_location_blue,{width:r,height:d}).addText([e.cancelledLocations||"0","Canceled Locations"].join(" "),{alignment:"left",color:OH.colors.label,fontSize:o.small}).endColumns().addGap({top:5,width:200}).beginColumns().addImage(OHIMAGES.icon_team_member_blue,{width:r,height:d}).addText([e.workers||"0","Worker(s)"].join(" "),{alignment:"left",color:OH.colors.label,fontSize:o.small}).endColumns().addGap({top:5,width:200}).beginColumns().addImage(OHIMAGES.icon_clock_blue,{width:r,height:d}).addText([e.estimatedMinutes||"0","Minutes Estimated"].join(" "),{alignment:"left",color:OH.colors.label,fontSize:o.small}).endColumns().toContent()),i(10,OH.colors.white),t({columns:n,columnGap:20,alignment:"justify"}),c},c.addServiceSummaryCharts=function(e){var o=new a,n=[];return o.width(544).beginColumns().addObject({left:0,image:OH.amCharts["chartJobCompletion_"+e.id].exportedImage,fit:[130,130]}).addObject({image:OH.charts.instances["ohJobCompletionLegend_"+e.id].dataUrl,fit:[130,230]}).addObject({left:0,image:OH.amCharts["chartJobExecution_"+e.id].exportedImage,fit:[130,130]}).addObject({image:OH.charts.instances["ohJobExecutionLegend_"+e.id].dataUrl,fit:[130,230]}).endColumns(),n.push(o.toContent()),t({margin:10,columns:n,columnGap:5}),c},c.addServiceExecutionByDayChart=function(e){var n=new a;return i(30,"#fff"),t(n.margin([180,0,0,0]).beginColumns().addImage(OHIMAGES.icon_calendar_green,{width:12,height:14}).addText("Services Executed By Day",{width:"*",alignment:"left",fontSize:o.large,color:OH.colors.green}).endColumns().toContent()),i(8,OH.colors.green),i(15,OH.colors.white),t({image:OH.amCharts["chartServicesExecutedByDay_"+e.id].exportedImage,fit:[523,200]}),c},c.addQuestionSectionTitle=function(e){return i(30,OH.colors.white),t({text:document.getElementById("questions_"+e.id).innerHTML,fontSize:o.normal,color:OH.colors.azure}),i(4,OH.colors.azure),c},c.addQuestionResponses=function(e){
function n(t){var o=[t.id,e.id].join("_");return"picklist"==t.type||"yesno"==t.type?OH.amCharts[o].exportedImage:OH.charts.instances[o].dataUrl}function i(e){switch(e){case"date":return[200,50];case"text":return[100,60];case"photo":return[100,60];case"signature":return[100,60];case"picklist":return[200,200];case"yesno":return[200,200];case"number":return[200,100];case"currency":return[200,100];case"time":return[200,100]}return[200,200]}function l(e,l){var r=new a,c=[];d++,r.width("49%").height(300).addText(["Q",d," - ",e.value].join(""),{fontSize:o.small,color:OH.colors.activeLabel}).addGap({top:10,width:200}).addObject({image:n(e),fit:i(e.type)}),c.push(r.toContent()),r=r.newInstance(),d++,l&&(r.width("*").height(300).addText(["Q",d," - ",l.value].join(""),{fontSize:o.small,color:OH.colors.activeLabel}).addGap({top:10,width:200}).addObject({image:n(l),fit:i(l.type)}),c.push(r.toContent())),t({margin:10,columns:c,columnGap:5})}var r=[],d=0;return e.questions.forEach(function(e){r.push(e),2===r.length&&(l(r[0],r[1]),r=[])}),r.length>0&&l(r[0],""),c},c.toPDF=function(){c.createLayout().pngifyCanvasElements().addPageTitle().addDisclaimer().addProjectTimeline().addSummary().addExecutedLocationsByDay(),OHPROJECT.services.forEach(function(e){c.addPageBreak().addServiceTitle(e.title,e.name).addServiceSummary(e).addServiceSummaryCharts(e).addServiceExecutionByDayChart(e).addQuestionSectionTitle(e).addQuestionResponses(e)});try{pdfMake.createPdf(d).open()}catch(e){console.log(e)}var t=e.setTimeout(function(){e.clearTimeout(t),l()},500)},{create:function(){r()}}}var o={xsmall:8,small:10,normal:12,large:14,xlarge:16};e.OHPDF=e.OHPDF||new t}(window),function(e){"use strict";function t(e){var t,o,n=[],i=e.servicesExecutedByDay||{},n=s();for(t in i)o=u(n,function(e){return e.date==t}),o&&(o.duration=i[t]||0);OH.charts.makeLineAreaChart("chartServicesExecutedByDay_"+e.id,{color:OH.colors.blue900,data:n,valueTitle:"Locations",fill:OH.colors.lightBlue500,lineColor:OH.colors.blue})}function o(e){var t=0,o=e.serviceJobCompletion||[],n=[];o.forEach(function(e){n.push({title:e.key,value:e.value,color:OH.colors[e.color||"green"]})}),0===n.length&&(n=[{title:"Completed",value:0,color:OH.colors.green},{title:"No authorized items",value:0,color:OH.colors.blue900},{title:"Display sold through",value:0,color:OH.colors.blue700},{title:"Manager refused",value:0,color:OH.colors.blue500},{title:"Display removed",value:0,color:OH.colors.blue400},{title:"Display Damaged",value:0,color:OH.colors.blue300},{title:"Did not complete",value:OHPROJECT.jobCount,color:OH.colors.blue100}]),n.forEach(function(e){e.value=e.value||0,t+=e.value}),n.forEach(function(e){e.title=e.title||"",e.percent=t>0?Math.round(100*e.value/t):0,e.label=[e.title.length>20?e.title.substring(0,20)+"...":e.title," - ",e.percent,"% (",e.value,")"].join("")});var i={width:250,height:300,top:40,title:"Completion",titleFontSize:24,labelFontSize:12,squareSize:15,color:OH.colors.label,data:n};OH.charts.makePieChart("chartJobCompletion_"+e.id,{innerRadius:"60%",radius:100,legend:{color:OH.colors.label},title:{fontSize:40,content:n[0].percent+"%",top:120,color:OH.colors.green},subTitle:{content:"Completed",fontSize:12,top:170,color:OH.colors.green},data:n}),OH.charts.makeChartLegend("ohJobCompletionLegend_"+e.id,i)}function n(e){var t,o=e.serviceJobExecution||[],n=e.notCancelledJobCount||1,i=[],a=[];o.length>0?o.forEach(function(e){t=Math.round(100*e.value/n),i.push({category:"",value:t,color:OH.colors[e.color||"grey300"]}),a.push({color:OH.colors[e.color||"grey300"],label:[e.value,e.key].join(" ")})}):(i=[{category:"",value:0,color:OH.colors.green},{category:"",value:0,color:OH.colors.blue}],a=[{color:OH.colors.green,label:"0 Jobs Executed"},{color:OH.colors.blue,label:"0 Jobs Completed"}]);var l={title:e.notCancelledJobCount,subTitle:"Total Jobs",legend:{width:250,height:300,top:40,title:"Job Execution",titleFontSize:24,labelFontSize:12,squareSize:15,callback:function(e){OH.charts.drawCircle(e,{top:155,left:30,radius:50,fill:"#ffffff",borderColor:OH.colors.green,borderWidth:1}),OH.charts.drawTextbox(e,{content:l.title,fontSize:32,fontWeight:700,textAlign:"center",width:100,fill:OH.colors.green,top:185,left:30}),OH.charts.drawTextbox(e,{content:l.subTitle,fontSize:12,fontWeight:400,textAlign:"center",width:100,fill:OH.colors.green,top:220,left:30})},data:a}};OH.charts.makeBarChart("chartJobExecution_"+e.id,{gridThickness:0,barWidth:35,labelText:"[[value]]%",labelColor:OH.colors.activeLabel,valueAxis:{minimum:0,maximum:100,color:OH.colors.green,labelColor:OH.colors.activeLabel,labelFunction:function(e){return 100==e?e+"%":""}},categoryAxis:{color:OH.colors.green},data:i}),OH.charts.makeChartLegend("ohJobExecutionLegend_"+e.id,l.legend)}function i(e,t){OH.charts.makeTextbox(e,{backgroundColor:t.backgroundColor,width:300,height:150,textAlign:"center",y:25,fontColor:OH.colors.white,fontSize:64,fontWeight:700,textContent:t.title,callback:function(e){var o=95;t.subTitle.forEach(function(t){OH.charts.drawTextbox(e,{fill:OH.colors.white,fontColor:OH.colors.white,content:t,top:o,left:0,fontSize:14,fontWeight:700,verticalAlign:"middle",width:300,height:50,textAlign:"center"}),o+=20})}})}function a(){i("ohExecution",{title:OHPROJECT.executionPercent||"0%",subTitle:[OHPROJECT.executedLocations+" locations",OHPROJECT.services.length+" service(s)"],backgroundColor:OH.colors.green})}function l(){i("ohLocations",{title:OHPROJECT.locations,subTitle:[OHPROJECT.budgetedLocations+" budgeted locations"],backgroundColor:OH.colors.orange})}function r(){OH.charts.makeTextbox("ohAccounts",{backgroundColor:"rgb(0, 112, 210)",textAlign:"center",verticalAlign:"middle",width:300,height:80,fontColor:"#ffffff",fontSize:13,fontWeight:700,textContent:OHPROJECT.account})}function c(){function e(e,t,o){var n,i={label:e,color:o||OH.colors.green};return t||3===t.split("-").length?(n=t.split("-"),i.data=[n[1],n[2],n[0]].join("/"),i):(i.data="",i)}var t,o,n,i=OHPROJECT;return o=[],i.launchDate&&o.push(e("Launch Date",i.launchDate)),i.startDate&&o.push(e("Start Date",i.startDate)),i.endDate&&o.push(e("End Date",i.endDate)),i.revisedEndDate&&i.revisedEndDate!=i.endDate&&o.push(e("Revised End Date",i.revisedEndDate,OH.colors.orange)),i.closeDate&&o.push(e("Close Date",i.closeDate)),t=Math.floor(100/(o.length-1)),n=0,o.forEach(function(e){e.value=n*t,n++}),o[n-1].value=100,o}function d(){OH.charts.makeTimeline("projectTimeline",{width:document.getElementById("projectTimeline").clientWidth,height:100,backgroundColor:OH.colors.green,data:c()})}function s(){var e,t=OHPROJECT,o=[],n=moment(t.startDate||t.launchDate),i=moment(t.closeDate||t.endDate);for(e=n;e<=i;)o.push({date:e.format("YYYY-MM-DD"),duration:0}),e.add(1,"d");return o}function u(e,t){var o=e.filter(function(e){return t(e)});return o.length>0?o[0]:void 0}function h(){var e,t,o=OHPROJECT.executedLocationsByDay||{},n=s();for(e in o)t=u(n,function(t){return t.date==e}),t&&(t.duration=o[e]||0);OH.charts.makeLineAreaChart("chartExecutedLocationsByDay",{color:OH.colors.blue900,data:n,valueTitle:"Locations",fill:OH.colors.lightBlue500,lineColor:OH.colors.blue})}function g(){var e=document.getElementById("btnExport");e.addEventListener("click",OH.toPDF,!1)}function f(){OH.initImages()}function A(){function e(){return[i.id,n].join("_")}function t(t){OH.charts.makeTextbox(e(),{paddingTop:30,backgroundColor:OH.colors.green,width:180,height:160,textAlign:"center",verticalAlign:"middle",fontColor:OH.colors.white,fontSize:v,fontWeight:400,textContent:i.data+"",callback:function(e){OH.charts.drawTextbox(e,{fontSize:p,fontWeight:700,fill:OH.colors.green,textAlign:"center",top:0,left:0,width:200,content:t})}})}function o(){OH.charts.makeManyTextboxes(e(),{width:500,height:180,fontSize:v,titleFontSize:p,titleFontColor:OH.colors.blue,fontWeight:400,fontColor:OH.colors.white,boxes:[{content:i.data[0].value+"",title:i.data[0].key+"",top:30,left:0,width:180,height:160,backgroundColor:OH.colors.blue,strokeWidth:10,textAlign:"center",verticalAlign:"middle",fill:OH.colors.blue},{content:i.data[1].value+"",title:i.data[1].key+"",titleFontColor:OH.colors.green,top:30,left:200,width:220,height:160,backgroundColor:OH.colors.green,strokeWidth:10,textAlign:"center",verticalAlign:"middle",fill:OH.colors.green}]})}var n,i,a={};return a.draw_date=function(){OH.charts.makeTextbox(e(),{backgroundColor:OH.colors.grey300,width:350,height:60,textAlign:"center",verticalAlign:"middle",fontColor:OH.colors.grey800,fontSize:14,fontWeight:400,textContent:i.data+""})},a.draw_text=function(){t("Total Responses")},a.draw_picklist=function(){var t=[],o=0,n=[OH.colors.green,OH.colors.blue,OH.colors.orange,OH.colors.grey300,OH.colors.blue300];i.data.forEach(function(e){t.push({category:e.key,value:e.value,color:n[o%5]}),o++}),OH.charts.makeBarChart(e(),{rotate:!0,marginLeft:200,gridThickness:0,barWidth:35,color:OH.colors.label,labelPosition:"right",labelColor:OH.colors.label,valueAxis:{hidden:!0,color:OH.colors.green,labelColor:OH.colors.activeLabel},categoryAxis:{color:OH.colors.white,textWrap:!0},data:t})},a.draw_yesno=function(){var t,o=0,n=[{title:i.data[0].key,value:i.data[0].value,color:OH.colors.green},{title:i.data[1].key,value:i.data[1].value,color:OH.colors.red500}];o=n[0].value+n[1].value,n.forEach(function(e){t=0===o||0===e.value?0:Math.round(100*e.value/o),e.label=[e.title," (",t,"% - ",e.value,")"].join("")}),OH.charts.makePieChart(e(),{innerRadius:"60%",radius:70,data:n,legend:{color:OH.colors.label,left:0,enabled:!0,position:"right",valueAlign:"left"}})},a.draw_number=function(){o()},a.draw_photo=function(){t("Total Photos")},a.draw_signature=function(){t("Total Signatures")},a.draw_currency=function(){o()},a.draw_time=function(){o()},a.render=function(e,t){var o="draw_"+t.type;n=e,i=t,a[o]?a[o]():console.log("The question type is not supported:"+t.type)},{draw:function(e,t){a.render(e,t)}}}function m(){var e,i=new A;OHPROJECT.services.forEach(function(a){e=document.getElementById("servicesExecutedByDayImage_"+a.id),e.src=OHIMAGES.icon_calendar_green,e=document.getElementById("cancelledLocationsCountImage_"+a.id),e.src=OHIMAGES.icon_cancel_location_blue,e=document.getElementById("workerCountImage_"+a.id),e.src=OHIMAGES.icon_team_member_blue,e=document.getElementById("estimatedMinutesImage_"+a.id),e.src=OHIMAGES.icon_clock_blue,o(a),n(a),t(a),a.questions.forEach(function(e){i.draw(a.id,e)})})}function b(){function e(e,t,o){l.push(['<div class="oh-question-card" itemtype="picklist"><h6>',"Q",t," - ",o.value,'</h6><div id="',o.id,"_",e,'" style="max-width: 100%; height: 260px;"></div></div>'].join(""))}function t(e,t,o){i=o.data||[],0===i.length&&(o.data=[{key:"YES",value:0},{key:"NO",value:0}]),l.push(['<div class="oh-question-card" itemtype="yesno"><h6>',"Q",t," - ",o.value,'</h6><div id="',o.id,"_",e,'" style="max-width: 400px; height: 200px;"></div></div>'].join(""))}function o(e,t,o){l.push(['<div class="oh-question-card" itemtype="',o.type,'"><h6>',"Q",t," - ",o.value,'</h6><canvas id="',o.id,"_",e,'" width="300" height="260"></canvas></div>'].join(""))}function n(e,t,o){i=o.data||[],0===i.length&&(o.data=[{key:"Average",value:"currency"===o.type?"$0.00":"0"},{key:"Total",value:"currency"===o.type?"$0.00":"0"}]),l.push(['<div class="oh-question-card" itemtype="',o.type,'"><h6>',"Q",t," - ",o.value,'</h6><canvas id="',o.id,"_",e,'" width="300" height="260"></canvas></div>'].join(""))}var i,a=document.getElementById("cmkQuestionTemplate").innerHTML,l=[],r=0,c=[];OHPROJECT.services.forEach(function(i){r=0,c=[],i.questions.forEach(function(d){switch(r++,d.type){case"text":case"photo":case"signature":o(i.id,r,d);break;case"number":case"currency":case"data":case"time":n(i.id,r,d);break;case"yesno":t(i.id,r,d);break;case"picklist":e(i.id,r,d)}2==l.length&&(c.push(a.replace("[[placeholder1]]",l[0]).replace("[[placeholder2]]",l[1])),l=[])}),l.length>0&&c.push(a.replace("[[placeholder1]]",l[0]).replace("[[placeholder2]]","")),l=[],document.getElementById("questionGroup_"+i.id).innerHTML=c.join("")}),l=null}var p=16,v=40;OH.onReady(function(){b(),f()}),OH.onLoad(function(){d(),a(),l(),r(),h(),m(),g()})}(window);